Detecting Outliers for Net Migration
====================================

The IRS data currently spans across 1992 to 2013 for a total of 68984 observations. There were substantial changes in data formatting and collecting across this time. As such, there are likely some data problems like clerical errors in reporting values or misclassifications in FIPS codes, etc. This is meant to be a quick and dirty way of detecting outliers in the data.

The process for detecting an outlier used here is to group the in-migration data for each county across the years (on average 22 years for each) and calculate the following:

\[ | X_i - median(X_{-i}) | > 7*sd(X_{-i}) \]

Values for which the above is true are flagged as potential outliers as this indicates the observation is approximately a seven sigma event (p-value of approximately 2.6e-12) and in expectation we should see one in 5663374 migration datasets if each county follows an independent normal distribution.

Exemptions (proxies population)
-------------------------------

|  year|   fips|  exmpt\_in|  mean\_in|  sd\_in|  flag\_factor|
|-----:|------:|----------:|---------:|-------:|-------------:|
|  1992|   2016|       2213|       559|     427|             4|
|  1992|  26103|       4283|      2218|     523|             2|
|  1992|  51840|       8798|      2535|    1483|             3|
|  1993|  28163|       1542|       880|     167|             2|
|  1994|  13125|       1217|       214|     232|             6|
|  1994|  42031|       2581|      1266|     310|             2|
|  1994|  42121|       5723|      1732|     904|             3|
|  1995|  13087|       9530|      1602|    1808|             6|
|  1995|  34033|       3965|      2517|     394|             2|
|  1996|   1055|       4866|      3607|     334|             1|
|  1996|  13261|       2253|      1240|     251|             2|
|  1998|  16015|       1364|       560|     199|             2|
|  2005|  22033|      27467|     16780|    2855|             2|
|  2005|  22103|      19355|     12299|    1758|             2|
|  2005|  28109|       4559|      2488|     514|             2|
|  2007|  21051|        781|       481|      79|             2|
|  2011|  18123|       1079|       655|     109|             2|
|  2011|  20029|       6542|       733|    1298|             9|
|  2011|  20089|       2667|       261|     539|            10|
|  2011|  20157|       4306|       402|     873|            11|
|  2011|  20183|       3150|       292|     639|            11|
|  2011|  21077|       1261|       538|     179|             2|
|  2011|  30007|        562|       327|      60|             2|
|  2011|  31149|        283|        74|      49|             4|
|  2011|  36025|       2849|      1785|     278|             2|
|  2011|  36049|       2772|      1006|     404|             3|
|  2011|  42115|       2563|      1593|     249|             2|
|  2011|  47061|       1326|       483|     193|             3|
|  2011|  47067|        517|       203|      74|             3|
|  2013|  48453|     208145|     63645|   35598|             3|

This is only meant as a quick and dirty way of detecting outliers, but there are a total of 30 flagged FIPS-year combinations. The column `flag_factor` is the flagged in-migration value for the county-year divided by the mean of in-migration for that county. The higher the value, the more unlikely the event.

Exemptions appear to not be that big of an issue and none of them appear to be obious mis-codings. I would be fine leaving these outliers in the dataset.

Adjusted Gross Income (AGI)
---------------------------

Using the same methodology as above, we can also detect any anomalies in the net-migration data that deal with AGI. This ends up being more of an issue than exemptions:

|  year|   fips|  agi\_in|  mean\_in|  sd\_in|  flag\_factor|
|-----:|------:|--------:|---------:|-------:|-------------:|
|  1992|  26069|    19925|     23958|    2878|             1|
|  1992|  42031|    15253|     19699|    5405|             1|
|  1992|  42039|    87090|     41976|   11710|             2|
|  1992|  51840|   125797|     47935|   22527|             3|
|  1993|  36117|   125708|     67573|   14828|             2|
|  1993|  48491|  -717998|    679937|  425865|            -1|
|  1994|  12003|    33981|     18704|    5494|             2|
|  1994|  21001|     5868|      7297|    1639|             1|
|  1994|  21137|  -990239|    -31330|  214201|            32|
|  1994|  42121|   105096|     28213|   17540|             4|
|  1994|  48027|   280965|    397822|   90249|             1|
|  1994|  51630|  -942328|     14742|  214785|           -64|
|  1994|  53011|  -688996|    441795|  276107|            -2|
|  1995|  26085|     9305|     10582|    2594|             1|
|  1995|  40067|     3081|      3849|    1082|             1|
|  1996|  48137|    14011|      2459|    2668|             6|
|  1997|  13197|     4121|      4276|    1026|             1|
|  1997|  13301|    -1090|      3146|    1064|             0|
|  1997|  13307|    -9341|       717|    2282|           -13|
|  1997|  39119|    38151|     39119|    5917|             1|
|  1997|  49017|     4134|      4112|    1185|             1|
|  1997|  51660|    11895|     34237|   15307|             0|
|  1998|  16015|    27729|     11009|    4657|             3|
|  1998|  19063|     4892|      5359|    1285|             1|
|  1998|  31177|    20529|     22415|    5128|             1|
|  1998|  38071|    26587|      8874|    4486|             3|
|  1998|  39057|   340566|    219221|   39412|             2|
|  1998|  46041|     9856|      2710|    1711|             4|
|  1998|  46117|    68357|      7958|   13628|             9|
|  1998|  48255|    35246|      9942|    7321|             4|
|  1998|  51141|     7686|      8682|    1537|             1|
|  1999|   1015|    68020|     70486|    5869|             1|
|  1999|  12107|    45676|     49894|    9788|             1|
|  1999|  20021|    12091|     12254|    2880|             1|
|  1999|  27035|    60727|     59922|   14699|             1|
|  1999|  30035|     4966|      5893|    1319|             1|
|  1999|  30059|     1222|      1636|     578|             1|
|  1999|  31129|     2229|      2385|     593|             1|
|  1999|  35023|     2344|      3293|     913|             1|
|  1999|  38069|     2170|      2869|     876|             1|
|  1999|  42083|    16076|     16937|    2272|             1|
|  1999|  44001|    61275|     66509|   15667|             1|
|  2000|  29061|     6094|      6343|    1196|             1|
|  2000|  36099|    79033|     24571|   12841|             3|
|  2000|  39135|    26651|     27150|    2644|             1|
|  2000|  46111|      989|      1505|     412|             1|
|  2000|  47173|    54956|     14837|    9592|             4|
|  2000|  48417|    10326|      3635|    3139|             3|
|  2000|  51185|    19868|     21505|    3655|             1|
|  2000|  53047|    25677|     29291|    6403|             1|
|  2000|  53071|   130781|     50054|   21327|             3|
|  2001|  16003|    -4469|      4024|    2332|            -1|
|  2001|  29117|     9169|      8992|    1624|             1|
|  2001|  54027|    64227|     17586|   11310|             4|
|  2002|  21065|     7780|      6172|    1391|             1|
|  2002|  21203|    14226|      6409|    2212|             2|
|  2002|  26149|    87490|     38069|   12531|             2|
|  2003|  19187|    18936|     21647|    3733|             1|
|  2003|  23009|   127954|     54160|   20721|             2|
|  2003|  35011|     1015|      1246|     281|             1|
|  2003|  39151|   181119|    191053|   30412|             1|
|  2003|  48333|    26196|      5277|    4879|             5|
|  2003|  48365|    14984|     18239|    5005|             1|
|  2004|  18175|    16914|     16111|    2546|             1|
|  2004|  20017|    32419|      3604|    6479|             9|
|  2005|  17021|    18563|     20237|    2637|             1|
|  2005|  22071|   166356|    354678|  129841|             0|
|  2005|  22075|    31070|     28884|    8071|             1|
|  2005|  22087|     3669|     30283|   12070|             0|
|  2005|  22105|   121328|     69883|   25119|             2|
|  2005|  28023|    28395|     11503|    4411|             2|
|  2005|  28045|    48211|     43917|   11384|             1|
|  2005|  28047|   165759|    190707|   37652|             1|
|  2005|  29151|    48537|      8732|    8995|             6|
|  2005|  39067|     8737|      9206|    2384|             1|
|  2005|  47081|    42676|     16593|    6579|             3|
|  2005|  48253|    13627|     12939|    3692|             1|
|  2006|  13031|   112158|     47020|   18605|             2|
|  2006|  19099|    33754|     27366|    5471|             1|
|  2006|  27133|     6357|      5622|     945|             1|
|  2006|  31097|    25562|      4017|    4878|             6|
|  2006|  31121|     6018|      5792|    1223|             1|
|  2006|  41001|    40127|     14204|    6118|             3|
|  2006|  42059|    17935|     18192|    4640|             1|
|  2006|  48211|     4392|      3434|    1535|             1|
|  2006|  48243|    15035|      3456|    2713|             4|
|  2006|  48399|    23658|      8139|    3907|             3|
|  2006|  48501|    20933|      6198|    3917|             3|
|  2006|  51113|    38948|     13637|    6751|             3|
|  2007|  12123|    10894|     11967|    3866|             1|
|  2007|  20097|     1445|      2082|     484|             1|
|  2007|  21139|    18466|      7639|    2798|             2|
|  2007|  30093|   -11875|     21608|    9236|            -1|
|  2007|  48143|    43434|     30376|    7589|             1|
|  2007|  55097|    86950|     49511|   12136|             2|
|  2007|  56045|    25162|      7134|    4729|             4|
|  2008|  13141|     3758|      4439|    1083|             1|
|  2008|  30027|    10979|      8714|    2520|             1|
|  2008|  38031|     2223|      2451|     586|             1|
|  2008|  48293|    18466|     15652|    3874|             1|
|  2008|  55029|    26066|     33217|    8793|             1|
|  2009|  18071|    63390|     27724|    9316|             2|
|  2009|  30009|   299182|     26620|   61117|            11|
|  2009|  46065|   136271|     23428|   26513|             6|
|  2009|  46121|     3093|      2862|     709|             1|
|  2009|  50001|    28768|     32934|    7372|             1|
|  2010|  19167|    15974|     15143|    3564|             1|
|  2010|  50009|     4978|      5351|    1399|             1|
|  2010|  55003|    18360|     11040|    2574|             2|
|  2010|  56015|    49206|     12897|    9384|             4|
|  2011|  13099|     6655|      4796|    1007|             1|
|  2011|  13257|    17700|     14803|    2362|             1|
|  2011|  16055|   175390|    142420|   37826|             1|
|  2011|  17139|    14958|     11383|    2061|             1|
|  2011|  17171|     7910|      3232|    1160|             2|
|  2011|  18061|    32627|     30070|    5127|             1|
|  2011|  18115|     6259|      5925|    1273|             1|
|  2011|  18123|    20474|      9659|    2936|             2|
|  2011|  19121|   -16210|     14979|    7980|            -1|
|  2011|  20029|   136476|     11763|   27871|            12|
|  2011|  20127|     4492|      4388|     915|             1|
|  2011|  20201|     2647|      2772|     645|             1|
|  2011|  21077|    21506|      7120|    3652|             3|
|  2011|  21191|    12364|     10398|    1907|             1|
|  2011|  22031|    30132|     19396|    6169|             2|
|  2011|  27075|    21018|      9441|    4005|             2|
|  2011|  31149|     5693|      1091|    1099|             5|
|  2011|  33007|    30157|     22850|    6805|             1|
|  2011|  36049|    51445|     14685|    8769|             4|
|  2011|  40045|     4809|      3294|    1678|             1|
|  2011|  40121|    35684|     27990|    7049|             1|
|  2011|  42131|    36637|     21201|    5640|             2|
|  2011|  45037|     6786|     15439|    6967|             0|
|  2011|  46005|    13573|     10690|    1908|             1|
|  2011|  46067|     6242|      4106|    1013|             2|
|  2011|  47061|    18129|      6430|    3200|             3|
|  2011|  47063|   110753|     47665|   20418|             2|
|  2011|  47067|     6990|      2319|    1161|             3|
|  2011|  47115|    21462|     16335|    3701|             1|
|  2011|  47185|    44207|     14872|    8474|             3|
|  2011|  48283|    10479|      4346|    4699|             2|
|  2011|  48313|    21342|     10018|    3126|             2|
|  2011|  54059|    12325|      9968|    7172|             1|
|  2011|  54085|     5944|      5458|    1270|             1|
|  2011|  54105|     8793|      3701|    1418|             2|
|  2011|  56019|    47705|     12845|    8917|             4|
|  2012|   1009|    44021|     38114|    8225|             1|
|  2012|   1043|    89174|     44395|   12525|             2|
|  2012|   1091|    13892|     10199|    1879|             1|
|  2012|   5069|    38630|     36053|    3264|             1|
|  2012|   5119|   711432|    342482|   97470|             2|
|  2012|   8037|   195641|    114841|   39232|             2|
|  2012|   8039|    72618|     48497|   19017|             1|
|  2012|  12073|   324832|    248397|   52532|             1|
|  2012|  13241|    53345|     17796|    9382|             3|
|  2012|  13263|     5477|      4664|     825|             1|
|  2012|  16013|   278882|     49329|   52446|             6|
|  2012|  17017|     7965|      8136|    1322|             1|
|  2012|  17121|    26530|     19998|    2934|             1|
|  2012|  17191|     7591|      6993|    1099|             1|
|  2012|  18127|   211634|    163837|   30783|             1|
|  2012|  19017|    42923|     20658|    6714|             2|
|  2012|  20075|   -20255|       545|    4696|           -37|
|  2012|  22037|    19478|     15918|    3086|             1|
|  2012|  24017|   261562|    192262|   53674|             1|
|  2012|  27023|    10317|      8240|    1454|             1|
|  2012|  27039|    21048|     18057|    4736|             1|
|  2012|  28027|    12234|      9604|    1247|             1|
|  2012|  28119|    18907|      3814|    3404|             5|
|  2012|  29023|    49180|     24571|    6353|             2|
|  2012|  30057|   129227|     14349|   25795|             9|
|  2012|  30075|     2237|      1149|     548|             2|
|  2012|  30091|     5550|      2324|    1345|             2|
|  2012|  31037|    11668|      6286|    2142|             2|
|  2012|  31167|    22251|      4664|    4385|             5|
|  2012|  33017|   218395|    136107|   35471|             2|
|  2012|  36001|  1019758|    315616|  169914|             3|
|  2012|  37061|    44155|     26836|    8599|             2|
|  2012|  40021|    39587|     27982|    6090|             1|
|  2012|  40047|    90703|     51865|   14527|             2|
|  2012|  40115|    79417|     22524|   14341|             4|
|  2012|  40127|    -6090|      5581|    3109|            -1|
|  2012|  46011|    83253|     27400|   13945|             3|
|  2012|  46029|   -19634|     20178|    9753|            -1|
|  2012|  46051|     5524|      4782|    1292|             1|
|  2012|  47021|    60351|     44348|    7734|             1|
|  2012|  48017|     5841|      3884|     927|             2|
|  2012|  48065|     7568|      6598|    1382|             1|
|  2012|  48099|   133371|    100421|   18835|             1|
|  2012|  48223|    34420|     24225|    6336|             1|
|  2012|  48285|    37972|     14273|    6866|             3|
|  2012|  48311|     2517|       919|     517|             3|
|  2012|  48327|     1806|      2248|    1758|             1|
|  2012|  51740|   212760|    113793|   33452|             2|
|  2012|  54081|    52870|     40733|    6597|             1|
|  2012|  54089|   -13647|      4408|    4137|            -3|
|  2012|  55085|   122782|     46445|   19045|             3|
|  2012|  56009|    25874|     15857|    5893|             2|
|  2012|  56033|   168574|     41232|   29970|             4|
|  2013|   5085|    89591|     71619|   19535|             1|
|  2013|   6023|    87708|     73906|   12744|             1|
|  2013|   8027|    37523|     10257|    6991|             4|
|  2013|  17113|   158555|    151049|   31674|             1|
|  2013|  20099|    14497|     11136|    1703|             1|
|  2013|  20109|     2378|      2094|     463|             1|
|  2013|  23013|    48361|     39158|    8664|             1|
|  2013|  26163|  2125746|    939266|  297196|             2|
|  2013|  27067|    29700|     27395|    5205|             1|
|  2013|  31185|    14385|     10201|    2033|             1|
|  2013|  34017|  1509994|    963712|  424353|             2|
|  2013|  38025|    23383|      3928|    5534|             6|
|  2013|  45063|   380637|    268994|   54689|             1|
|  2013|  46053|     7350|      2521|    1327|             3|
|  2013|  48055|    45555|     34687|    9494|             1|
|  2013|  48095|    26993|      3586|    5286|             8|
|  2013|  53007|   144892|     77331|   23986|             2|
|  2013|  53055|  -106733|     34999|   35841|            -3|

There are some implausible values here, especially when considering that the AGI variable is measured in terms of $1,000s.
